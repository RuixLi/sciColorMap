function map = bilbao(m)
%   BILBAO a scientific colour map 6 by FabioCrameri et al.
%   bilbao(M) returns an M-by-3 matrix containing a colormap. 
%   written by Ruix.Li in Jan, 2021

% USAGE:
% colormap(bilbao(128))
% colormap bilbao

if nargin < 1
   f = get(groot,'CurrentFigure');
   if isempty(f)
      m = size(get(groot,'DefaultFigureColormap'),1);
   else
      m = size(f.Colormap,1);
   end
end

values = [
   1.000000000000000   1.000000000000000   0.999908969988911
   0.994880741732794   0.994862215977719   0.994733896545001
   0.989762845858676   0.989731992621681   0.989565666063634
   0.984648937848754   0.984604345423422   0.984393632477301
   0.979539397994012   0.979479354905341   0.979217012617141
   0.974435334962116   0.974358346315919   0.974039155341697
   0.969344292255278   0.969247839219191   0.968861026053698
   0.964259609351318   0.964140998523970   0.963676077756448
   0.959189022734535   0.959045190510730   0.958489781902473
   0.954126528973053   0.953953771355573   0.953292780702549
   0.949072586336095   0.948866140306926   0.948083477366677
   0.944035096939853   0.943790431104964   0.942868989716108
   0.939008847825715   0.938720666686107   0.937637626941750
   0.933994763992123   0.933656530061175   0.932389911480702
   0.929001213207217   0.928606237002158   0.927130064559706
   0.924028784080142   0.923571406402841   0.921857154540129
   0.919069402504778   0.918538431244851   0.916557672448510
   0.914142203955108   0.913527444743617   0.911238665905622
   0.909229867049286   0.908525211308980   0.905898410349091
   0.904348886928347   0.903540461807997   0.900528024137843
   0.899502244323874   0.898571303206429   0.895136401094797
   0.894685783422573   0.893624620177441   0.889711493237919
   0.889901326664346   0.888704671388823   0.884262955895996
   0.885162339927712   0.883806641829641   0.878778607198551
   0.880464607815539   0.878932221549279   0.873268025410091
   0.875819813351139   0.874093993751544   0.867727904700113
   0.871224259747092   0.869292358056286   0.862157798441027
   0.866684519829896   0.864526339822346   0.856550121552525
   0.862214007832145   0.859803906992487   0.850915588334226
   0.857797741246187   0.855127436512262   0.845259346879891
   0.853456812289791   0.850496277742199   0.839577105417674
   0.849198530267441   0.845922700431403   0.833868003030626
   0.845013288525776   0.841412078244721   0.828131817210302
   0.840914056870929   0.836961139692697   0.822387449394210
   0.836902961305116   0.832574057800642   0.816622463373526
   0.832981152450917   0.828258911966569   0.810843056942073
   0.829162577032570   0.824018028757323   0.805059201645966
   0.825431865753231   0.819853705375896   0.799276309583475
   0.821812869765229   0.815776483038189   0.793489388454696
   0.818286603711245   0.811775780062648   0.787699966449430
   0.814872515148934   0.807860825950971   0.781928525568369
   0.811565291891464   0.804033890438948   0.776161801590015
   0.808360651614643   0.800294554671021   0.770412913074294
   0.805258581734528   0.796638392657496   0.764684629183066
   0.802265415037973   0.793080539421887   0.758974982591494
   0.799380524560900   0.789603892739513   0.753289775804972
   0.796584796012625   0.786218124584840   0.747641040904447
   0.793901326636559   0.782909832205517   0.742011031594758
   0.791301047710760   0.779691032215930   0.736412692981792
   0.788802372176557   0.776556280936299   0.730851054137544
   0.786389899489298   0.773490468727599   0.725327160757203
   0.784060882812303   0.770508663594624   0.719827399574165
   0.781810370758251   0.767591168524488   0.714358403254530
   0.779632835143135   0.764750032983966   0.708936354596013
   0.777535557640249   0.761963725411043   0.703534401600179
   0.775494579161699   0.759241202074265   0.698163850787496
   0.773519585384240   0.756577394576200   0.692836528574490
   0.771608708326049   0.753963729993179   0.687524399610452
   0.769739892721960   0.751399791591861   0.682241137852043
   0.767922929827696   0.748867665579745   0.676995813731937
   0.766155324064489   0.746382595546701   0.671760537236827
   0.764422266396747   0.743932100721783   0.666550123154194
   0.762722961763954   0.741506924210533   0.661368522713470
   0.761060999349964   0.739120860730656   0.656203496513181
   0.759419975417396   0.736741511890447   0.651046839055858
   0.757812538142091   0.734389997471463   0.645904081334180
   0.756220867574274   0.732050505487231   0.640778643066945
   0.754652492989617   0.729719460398224   0.635662249372184
   0.753086961948093   0.727392410706163   0.630559377139843
   0.751551347023482   0.725076561658685   0.625450713170213
   0.750009219301670   0.722745457322081   0.620358625302587
   0.748486071009324   0.720419081171245   0.615251975912214
   0.746964634763371   0.718081950095128   0.610157256540687
   0.745443837299600   0.715733893410886   0.605060458562650
   0.743927998504020   0.713356797653805   0.599960586677357
   0.742411290361615   0.710965520290199   0.594852356079216
   0.740883826766450   0.708544039931914   0.589735717912262
   0.739367654997763   0.706088012994422   0.584622548367111
   0.737825553613064   0.703594617135116   0.579498974155476
   0.736284160461268   0.701060273472304   0.574352018237258
   0.734741363979541   0.698475944392004   0.569208335981174
   0.733179211285689   0.695849662631452   0.564064364358451
   0.731605000731422   0.693160962271508   0.558893946692848
   0.730023610230061   0.690405114500684   0.553729223392888
   0.728420926736830   0.687593017267278   0.548569079963278
   0.726809919841437   0.684705842741991   0.543392806387742
   0.725189183858992   0.681746425252846   0.538231271501200
   0.723542274333161   0.678717279950190   0.533065078632335
   0.721887576342686   0.675608166505181   0.527917274820470
   0.720225545612803   0.672422737753248   0.522795520141561
   0.718546397575546   0.669151405218982   0.517701427329739
   0.716866254230863   0.665800854757096   0.512632306793256
   0.715167621221593   0.662377840284334   0.507619657256768
   0.713465538798771   0.658865438688284   0.502648977578381
   0.711763466884156   0.655290093987081   0.497762347830425
   0.710057908653825   0.651649662813871   0.492920118894898
   0.708356513918664   0.647932560115539   0.488191169891147
   0.706661824464736   0.644163895402495   0.483532869664224
   0.704969751133953   0.640349892645951   0.478993974102221
   0.703296852246613   0.636486747747221   0.474566931288366
   0.701630865527198   0.632579402139669   0.470255397392618
   0.699991796614784   0.628648227858975   0.466063198492095
   0.698369982025605   0.624689476546220   0.462018761600344
   0.696777222109701   0.620722091815614   0.458105788950349
   0.695206737731552   0.616740508791254   0.454345277859018
   0.693663404637656   0.612751429805219   0.450717273198441
   0.692158883673674   0.608786648408280   0.447232072846095
   0.690669004439669   0.604814926281036   0.443905620980513
   0.689229301213676   0.600860400250879   0.440701218326116
   0.687808121957628   0.596934517523483   0.437660981208537
   0.686422414620544   0.593026854839796   0.434735691169680
   0.685070702488294   0.589133309310016   0.431952647748472
   0.683745108152382   0.585289434304135   0.429274849366803
   0.682453353583810   0.581454800061452   0.426724693096429
   0.681187609849821   0.577655227482252   0.424281675325837
   0.679952603689782   0.573890381739837   0.421937823214731
   0.678746068723236   0.570149448146819   0.419706831637161
   0.677567630660617   0.566446577459587   0.417552577526174
   0.676401087843441   0.562767928139286   0.415472065423796
   0.675257165227920   0.559102870495886   0.413474605222686
   0.674134320934685   0.555467966432047   0.411533585106359
   0.673033084618153   0.551869257770909   0.409664563793760
   0.671939959510100   0.548283335196219   0.407837783248548
   0.670867842705798   0.544709952690360   0.406070694544810
   0.669805896160318   0.541154609757756   0.404327639175425
   0.668752717522604   0.537630039339808   0.402631742153171
   0.667713386654692   0.534100362180342   0.400984438646913
   0.666672288017764   0.530598549312556   0.399329306469573
   0.665652487330341   0.527107173823164   0.397731725289855
   0.664630128111210   0.523619475423780   0.396142957457945
   0.663626835437167   0.520134277513524   0.394568242860439
   0.662618499633303   0.516671546001963   0.393013327515861
   0.661615189550979   0.513210639067748   0.391480978601756
   0.660608780809069   0.509753103400068   0.389939362785231
   0.659616415957984   0.506297604971405   0.388428398866003
   0.658619611373436   0.502849916618276   0.386907892765526
   0.657636017678107   0.499406572134326   0.385403023797986
   0.656644805490022   0.495966428548951   0.383911997425937
   0.655654289264143   0.492529393772820   0.382410665320160
   0.654660554831855   0.489094687670147   0.380932512054329
   0.653676336599838   0.485660135760515   0.379434596549608
   0.652687216333366   0.482234509355335   0.377948336794477
   0.651708172078349   0.478798304653147   0.376473208731134
   0.650718576887925   0.475374476836051   0.374977924394938
   0.649733914199374   0.471941497042035   0.373496094937707
   0.648743996161989   0.468500775064159   0.372005351139694
   0.647751191265991   0.465066896635930   0.370521390778460
   0.646764992385089   0.461637512528394   0.369046125999608
   0.645767497652656   0.458197166168377   0.367547709037964
   0.644771901374679   0.454769302948147   0.366071041607230
   0.643774398776470   0.451324392486722   0.364569749254357
   0.642777519112825   0.447872630049388   0.363074154301996
   0.641770148380133   0.444441381964806   0.361581801053105
   0.640760629932939   0.440978026226802   0.360071980694051
   0.639749007999581   0.437537650194653   0.358558862357595
   0.638724148393378   0.434062596843817   0.357059301035568
   0.637695097364339   0.430606780000856   0.355536861126573
   0.636661213870460   0.427139135642533   0.353988615844002
   0.635606516241101   0.423646850053132   0.352450800714582
   0.634552157387569   0.420163052541556   0.350908055689564
   0.633477022144348   0.416668782731675   0.349334499014143
   0.632387548793423   0.413162292134258   0.347757420628534
   0.631284163815440   0.409638141800065   0.346145355298455
   0.630158979917128   0.406106334406912   0.344533657575114
   0.629011286562419   0.402544607991913   0.342911831981552
   0.627842859561912   0.398978165830969   0.341245023016982
   0.626642532904436   0.395403600678101   0.339567923374125
   0.625416025242723   0.391796702493617   0.337839417998500
   0.624160751316517   0.388167514647392   0.336093058937716
   0.622861198265102   0.384515278321879   0.334326900622587
   0.621520111174802   0.380853353633047   0.332512552778636
   0.620148954176967   0.377148440862781   0.330636103689417
   0.618722047585357   0.373413594630322   0.328744037127004
   0.617237057026484   0.369651142415699   0.326777956912984
   0.615699453215924   0.365864866690569   0.324775745655360
   0.614102102314103   0.362039873784142   0.322735635422060
   0.612446021680994   0.358175498296071   0.320621102039308
   0.610726620320882   0.354274959662528   0.318430251217140
   0.608934346675517   0.350346494644816   0.316194758558625
   0.607060318274797   0.346357418865289   0.313875830986896
   0.605102181989314   0.342354120866870   0.311479847267719
   0.603069825303220   0.338285897149366   0.309040117229981
   0.600947309816741   0.334205828360733   0.306497671246170
   0.598740063643949   0.330067935899344   0.303863890972003
   0.596442691607641   0.325875831289798   0.301162470019787
   0.594049312884034   0.321666863386701   0.298383239647443
   0.591564572605766   0.317419633522400   0.295519440367926
   0.588973547119638   0.313130881301554   0.292571736845229
   0.586302004694262   0.308819066442455   0.289546602016066
   0.583521972995666   0.304446983690837   0.286410771611203
   0.580652715873404   0.300059891817573   0.283228035687476
   0.577679843572665   0.295640455438771   0.279940167625986
   0.574617135466899   0.291211553949974   0.276584503124322
   0.571466957915866   0.286726989244739   0.273137731298851
   0.568222900090603   0.282267065084013   0.269626238677323
   0.564887939604786   0.277757280487542   0.266032369266068
   0.561477886780957   0.273242647379321   0.262363840577601
   0.557977107410638   0.268718474677968   0.258636959571717
   0.554407927286313   0.264179812431137   0.254861349007375
   0.550758242090220   0.259639352089654   0.251002215859730
   0.547039738166792   0.255098657327606   0.247090183676787
   0.543257510396521   0.250527563656492   0.243122472124107
   0.539405663094821   0.245981319863637   0.239130165737786
   0.535501274021562   0.241455892180766   0.235103468173400
   0.531549433920736   0.236932411916061   0.231002841875854
   0.527541834459084   0.232388033537031   0.226883543197236
   0.523492446538378   0.227871587522712   0.222731784826322
   0.519395490436995   0.223356507542626   0.218545423371653
   0.515256527806994   0.218850734421002   0.214337422128741
   0.511085876790011   0.214356355319167   0.210103550806580
   0.506884121522243   0.209868832644651   0.205871519778495
   0.502648704849060   0.205397570095629   0.201580768696370
   0.498399967974167   0.200920077066685   0.197330080882713
   0.494107032779170   0.196512460617173   0.193042879377097
   0.489788373942530   0.192047867294090   0.188760848767236
   0.485455731918670   0.187650849388503   0.184459646651208
   0.481101351043882   0.183191392472794   0.180154182155316
   0.476733026789569   0.178801715282912   0.175845637780352
   0.472344336083804   0.174395418912916   0.171570450081182
   0.467928139058144   0.169997636104163   0.167303490762074
   0.463497722982868   0.165567121546845   0.163022477509263
   0.459060705259977   0.161221985356004   0.158751381594234
   0.454602036116119   0.156817580350963   0.154465434906921
   0.450116057498338   0.152405639342278   0.150238154725585
   0.445611769151359   0.148030238820461   0.146005089697987
   0.441099574417722   0.143643997048752   0.141783389052362
   0.436575191238066   0.139212476188716   0.137599824366334
   0.432033580303955   0.134856411274143   0.133402343396948
   0.427462469161572   0.130452566681570   0.129227062094498
   0.422861363046581   0.126012086574848   0.125101892976791
   0.418258050558809   0.121517024350735   0.120972089943167
   0.413641993988507   0.117079948268929   0.116915461710445
   0.408998280532461   0.112651691671940   0.112910941202521
   0.404333611150524   0.108099490147316   0.108855357760486
   0.399648597277992   0.103633863622024   0.104837760320879
   0.394959977472745   0.099058697162095   0.100920078707743
   0.390238009721158   0.094525236416877   0.096993501573424
   0.385502879410163   0.089887909938144   0.093119359481578
   0.380766771651412   0.085202321446911   0.089344124763205
   0.375996288102303   0.080517916667762   0.085504882362152
   0.371203643009257   0.075750533371368   0.081859362699314
   0.366423369709088   0.070994461757408   0.078057686300133
   0.361624332386228   0.066080511493624   0.074313063676704
   0.356839847653426   0.061063599018418   0.070322403406531
   0.352042815758085   0.056052177682231   0.066181874617912
   0.347286527877276   0.050812683334795   0.061796644604406
   0.342522221730317   0.045462430894725   0.057219336837919
   0.337761867947891   0.039996957837707   0.052327391494879
   0.333037716693832   0.034289104439143   0.047198251932364
   0.328305054496872   0.028993963575061   0.041678929476374
   0.323598546953630   0.023946569694723   0.035719768601857
   0.318913945892975   0.019129702413930   0.029527907081103
   0.314244223223995   0.014538500348607   0.023554478423094
   0.309613501203806   0.009959564946877   0.017575427127204
   0.304982444390329   0.005813235331602   0.011558667252876
   0.300376364621568   0.001864890181019   0.005395009309447
   ];

values = flipud(values);
P = size(values,1);
map = interp1(1:size(values,1), values, linspace(1,P,m), 'linear');
